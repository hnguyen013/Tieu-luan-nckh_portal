{% extends "portal/home_base.html" %}
{% load static %}

{% block title %}D·ªØ li·ªáu sinh vi√™n - ƒê·ªÅ t√†i nghi√™n c·ª©u khoa h·ªçc{% endblock %}

{% block content %}
    <!-- PH·∫¶N 1: HERO + KHUNG L·ªåC -->
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <!-- B√™n tr√°i: ti√™u ƒë·ªÅ -->
            <div class="hero-left">
                <h1 class="hero-title">
                    <span class="title-line-1">D·ªØ li·ªáu sinh vi√™n</span><br>
                    <span class="title-line-2">Sinh vi√™n tham gia ƒë·ªÅ t√†i NCKH</span>
                </h1>
                <p class="hero-subtitle">
                    L·ªçc theo khoa, kh√≥a h·ªçc v√† t·ª´ kh√≥a ƒë·ªÉ t√¨m nhanh sinh vi√™n trong to√†n tr∆∞·ªùng.
                </p>
            </div>

            <!-- B√™n ph·∫£i: khung l·ªçc sinh vi√™n -->
            <div class="hero-right">
                <div class="search-card">
                    <h2>L·ªçc <span class="highlight">Sinh vi√™n</span></h2>

                    <form method="get" action="{% url 'portal:public-student-list' %}">
                        <!-- KH√ìA H·ªåC -->
                        <select name="course_id">
                            <option value="">Ch·ªçn kh√≥a h·ªçc</option>
                            {% for c in course_list %}
                                <option value="{{ c.id }}" {% if c.id|stringformat:"s" == course_id %}selected{% endif %}>
                                    {{ c.code }} - {{ c.name }}
                                </option>
                            {% endfor %}
                        </select>

                        <!-- KHOA -->
                        <select name="faculty_id">
                            <option value="">Ch·ªçn khoa</option>
                            {% for f in faculty_list %}
                                <option value="{{ f.id }}" {% if f.id|stringformat:"s" == faculty_id %}selected{% endif %}>
                                    {{ f.name }}
                                </option>
                            {% endfor %}
                        </select>

                        <input type="text"
                               name="q"
                               placeholder="T√¨m MSSV / H·ªç t√™n / Ng√†nh / Email"
                               value="{{ q }}"/>

                        <button type="submit">T√¨m ki·∫øm</button>
                    </form>

                </div>
            </div>
        </div>
    </section>

    <!-- PH·∫¶N 2: K·∫æT QU·∫¢ T√åM KI·∫æM -->
    <section class="students-section">
        <div class="container">
            <div class="results-header">
                <h2 class="results-title">D·ªØ li·ªáu sinh vi√™n</h2>
                <div class="results-count">
                    {{ students|length }} K·∫æT QU·∫¢<br>
                </div>
            </div>

            <div class="student-grid">
                {% for s in students %}
                    <div class="student-card">
                        <div class="student-card-inner">
                            <div class="student-avatar">
                                {% if s.avatar %}
                                    <img src="{{ s.avatar.url }}" alt="{{ s.full_name }}">
                                {% else %}
                                    <span class="avatar-placeholder">üë§</span>
                                {% endif %}
                            </div>

                            <h3 class="student-name">{{ s.full_name }}</h3>
                            <p class="student-role">Sinh vi√™n</p>

                            <div class="student-info">
                                <p><strong>MSSV:</strong> {{ s.mssv }}</p>
                                <p><strong>Ng√†y sinh:</strong> {{ s.date_of_birth|date:"d/m/Y" }}</p>
                                <p><strong>Gi·ªõi t√≠nh:</strong> {{ s.get_gender_display }}</p>
                                <p><strong>Ng√†nh:</strong> {{ s.major.name }}</p>
                                <p><strong>Khoa:</strong> {{ s.faculty.name }}</p>
                                <p><strong>Kh√≥a:</strong> {{ s.course.name }}</p>
                                {% if s.email %}
                                    <p><strong>Email:</strong> {{ s.email }}</p>
                                {% endif %}
                            </div>

                            <a href="{% url 'portal:public-student-detail' s.mssv %}"
                               class="btn-detail">
                                Xem chi ti·∫øt
                            </a>
                        </div>
                    </div>
                {% empty %}
                    <p>Ch∆∞a c√≥ sinh vi√™n n√†o trong h·ªá th·ªëng.</p>
                {% endfor %}
            </div>
        </div>
    </section>
{% endblock %}
